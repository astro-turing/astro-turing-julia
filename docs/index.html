<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Julia implementation of some numerical PDE solvers</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="theme.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Julia implementation of some numerical PDE solvers</h1>
<p class="subtitle">diagenetic modelling in Julia</p>
<!--        <div id="dark-mode-toggle">
                <p>Dark mode: <button class="dark-mode-button"
                        aria-label="Toggle dark mode"
                        onclick="toggle_dark_mode()">
                        <span></span><span></span>
                </button></p>
</div> -->
</header>
<div class="row">
        <div class="col-6 col-s-9" id="main">
<p><a href="https://entangled.github.io/"><img src="https://img.shields.io/badge/entangled-Use%20the%20source!-%2300aeff" alt="Entangled badge" /></a></p>
<section id="diagenetic-modelling-in-julia" class="level1">
<h1>Diagenetic modelling in Julia</h1>
<p>This repository contains example codes to solve numerical PDEs in Julia. The goal is to reproduce the results from Ivan l’Heureux 2018. We’ll work from basics of solving PDEs to running the full model.</p>
<ul>
<li><a href="./diffusion.html">Diffusion equation</a></li>
<li><a href="./upwind-scheme.html">Advection equation</a></li>
<li><a href="./fiadeiro-veronis.html">Fiadeiro-Veronis scheme</a></li>
<li><a href="./lheureux-model.html">l’Heureux model</a></li>
</ul>
</section>
<section id="architecture" class="level1">
<h1>Architecture</h1>
<p>In this implementation, readability is a primary concern. The target model has five long equations and more than 30 free parameters. It would be a shame if we have to mix the intricacies of numerical methods with the actual implementation of the model. When solving partial differential equations, this means that we may want to write the actual PDEs in a natural form, and then automatically generate the space descretisation for each equation. There is a set of Julia package called <code>ModelingToolkit.jl</code> and more specifically <code>MethodOfLines.jl</code> that implements a scheme like this, so we could end up using that. For now, using those would fall outside of the scope of the project due to time constraints (Learning how to use these and adapting the model could take a significant effort).</p>
<p>We may for our case adopt a more bare bones approach. We define two functions that we may use inside our PDE: <code>partial</code> and <code>partial_2</code> used for advective and diffusion terms respectively. Then we design a ring algebra around these operators. From an input vector (our model is one-dimensional) we can then, given a finite difference method and boundary conditions, automatically generate the matrix equations that we need to solve.</p>
<div class="named-code-block">
<p>«differential-operators»</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> <span class="dt">Expr</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    delayed</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="bu">Base</span>.<span class="op">:+</span>(y<span class="op">::</span><span class="dt">Vector</span>{<span class="dt">Float64</span>}<span class="op">,</span> <span class="cn">e</span><span class="op">::</span><span class="dt">Expr</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="bu">Base</span>.<span class="op">:+</span>(<span class="cn">e</span><span class="op">::</span><span class="dt">Expr</span><span class="op">,</span> y<span class="op">::</span><span class="dt">Vector</span>{<span class="dt">Float64</span>})</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:+</span>(e1<span class="op">::</span><span class="dt">Expr</span><span class="op">,</span> e2<span class="op">::</span><span class="dt">Expr</span>) <span class="op">=</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Expr</span>((method<span class="op">,</span> bc) <span class="op">-&gt;</span> e1.delayed(method<span class="op">,</span> bc) <span class="op">+</span> e2.delayed(method<span class="op">,</span> bc))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:*</span>(y<span class="op">::</span><span class="dt">Vector</span>{<span class="dt">Float64</span>}<span class="op">,</span> <span class="cn">e</span><span class="op">::</span><span class="dt">Expr</span>) <span class="op">=</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>partial(y) <span class="op">=</span> <span class="dt">Expr</span>((method<span class="op">,</span> bc) <span class="op">-&gt;</span> method.partial(bc<span class="op">,</span> y))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>partial_2(y) <span class="op">=</span> <span class="dt">Expr</span>((method<span class="op">,</span> bc) <span class="op">-&gt;</span> method.partial_2(bc<span class="op">,</span> y))</span></code></pre></div>
</div>
</section>
        </div>
         <div class="col-3 col-s-3 menu" id="menu-container">
                <div id="menu"><nav id="TOC" role="doc-toc">
                                <ul>
                                <li><a href="#diagenetic-modelling-in-julia">Diagenetic modelling in Julia</a></li>
                                <li><a href="#architecture">Architecture</a></li>
                                </ul>
                </nav></div>
        </div> 
</div>
<div class="footer">
<a href="https://esciencecenter.nl">Netherlands eScience Center</a> and <a href="https://www.uu.nl/organisatie/faculteit-geowetenschappen">Utrecht University, faculty of geosciences</a>
</div>
<!-- <script>
function toggle_dark_mode() {
    var app = document.getElementsByTagName("BODY")[0];
    if (localStorage.darkMode == "dark") {
	localStorage.darkMode = "light";
	app.setAttribute("dark-mode", "light");
    } else {
	localStorage.darkMode = "dark";
	app.setAttribute("dark-mode", "dark");
    }
}
</script> -->
</body>
</html>
